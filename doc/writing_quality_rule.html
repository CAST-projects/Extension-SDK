

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Writing quality rules &mdash; CAST Extension SDK 1.6.6 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="CAST Extension SDK 1.6.6 documentation" href="index.html"/>
        <link rel="next" title="API Reference" href="code_reference.html"/>
        <link rel="prev" title="Debugging" href="debugging.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> CAST Extension SDK
          

          
          </a>

          
            
            
              <div class="version">
                1.6.6
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="my_first_plugin.html">Tutorial : My first plugin</a></li>
<li class="toctree-l1"><a class="reference internal" href="deployment.html">Deploying plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="manual.html">Creating a plugin</a></li>
<li class="toctree-l1"><a class="reference internal" href="analyser_level.html">Running during analysis of an existing analyser</a></li>
<li class="toctree-l1"><a class="reference internal" href="application_level.html">Running code after analyzers</a></li>
<li class="toctree-l1"><a class="reference internal" href="data_exchange.html">Exchanging data between analysis level and application level</a></li>
<li class="toctree-l1"><a class="reference internal" href="analysers_specif.html">Analysers specific events</a></li>
<li class="toctree-l1"><a class="reference internal" href="mainframe.html">Mainframe Analyser specificities</a></li>
<li class="toctree-l1"><a class="reference internal" href="html5.html">HTML5/Javascript Analyser specificities</a></li>
<li class="toctree-l1"><a class="reference internal" href="python.html">Python Analyser specificities</a></li>
<li class="toctree-l1"><a class="reference internal" href="roslyn.html">Dotnet Analyser specificities</a></li>
<li class="toctree-l1"><a class="reference internal" href="debugging.html">Debugging</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Writing quality rules</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#tutorial">Tutorial</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#starter-kits">Starter kits</a></li>
<li class="toctree-l3"><a class="reference internal" href="#initialization">Initialization</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#plugin-id">Plugin id</a></li>
<li class="toctree-l4"><a class="reference internal" href="#pck-name">Pck name</a></li>
<li class="toctree-l4"><a class="reference internal" href="#metamodel-ids">Metamodel ids</a></li>
<li class="toctree-l4"><a class="reference internal" href="#a-custom-category">A custom category</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#adding-a-new-quality-rule">Adding a new quality rule</a></li>
<li class="toctree-l3"><a class="reference internal" href="#adding-a-property">Adding a property</a></li>
<li class="toctree-l3"><a class="reference internal" href="#implementation-in-python">Implementation in Python</a></li>
<li class="toctree-l3"><a class="reference internal" href="#adding-the-rule-in-the-master-files">Adding the rule in the master files</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#metricsdirectory-xml">MetricsDirectory.xml</a></li>
<li class="toctree-l4"><a class="reference internal" href="#implqualityrules-xml">IMPLQualityRules.xml</a></li>
<li class="toctree-l4"><a class="reference internal" href="#specthresholds-xml">SPECThresholds.xml</a></li>
<li class="toctree-l4"><a class="reference internal" href="#speccontributors-xml">SPECContributors.xml</a></li>
<li class="toctree-l4"><a class="reference internal" href="#impltechnologies-xml">IMPLTechnologies.xml</a></li>
<li class="toctree-l4"><a class="reference internal" href="#specdocumentation-xml">SPECDocumentation.xml</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#compiling-the-master-files">Compiling the master files</a></li>
<li class="toctree-l3"><a class="reference internal" href="#done">Done</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#some-other-ways-of-writing-quality-rules">Some other ways of writing quality rules</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#old-way-of-writing-quality-rules">Old way of writing quality rules</a></li>
<li class="toctree-l3"><a class="reference internal" href="#different-ways-of-producing-properties">Different ways of producing properties</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#packaging">Packaging</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#adding-the-rule-manually-to-cms">Adding the rule manually to CMS</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#enhancing-dataflow-quality-rules">Enhancing dataflow quality rules</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#configuring-dataflow">Configuring dataflow</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="code_reference.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="version_compatibility.html">Features and Bugs per CAIP versions</a></li>
<li class="toctree-l1"><a class="reference internal" href="tips_and_tricks.html">Tips and tricks</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">CAST Extension SDK</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>Writing quality rules</li>
    <li class="wy-breadcrumbs-aside">
      
        
          <a href="_sources/writing_quality_rule.txt" rel="nofollow"> View page source</a>
        
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="writing-quality-rules">
<h1>Writing quality rules<a class="headerlink" href="#writing-quality-rules" title="Permalink to this headline">¶</a></h1>
<div class="section" id="tutorial">
<h2>Tutorial<a class="headerlink" href="#tutorial" title="Permalink to this headline">¶</a></h2>
<p>This tutorial applies to <strong>COBOL</strong> but can be translated to other technologies.</p>
<div class="section" id="starter-kits">
<span id="starter-kit"></span><h3>Starter kits<a class="headerlink" href="#starter-kits" title="Permalink to this headline">¶</a></h3>
<p>Here are some sample projects that demonstrate the complete development of a quality rule.</p>
<ul class="simple">
<li>COBOL</li>
</ul>
<blockquote>
<div><ul class="simple">
<li><a class="reference external" href="https://github.com/CAST-projects/Extension-SDK/tree/master/samples/analyzer_level/mainframe/mainframe.quality_rule">COBOL sample project</a> you can have a look at its git history for more details.</li>
</ul>
</div></blockquote>
<ul class="simple">
<li>HTML5/Javascript</li>
</ul>
<blockquote>
<div><ul class="simple">
<li><a class="reference external" href="https://github.com/CAST-projects/Extension-SDK/tree/master/samples/analyzer_level/html5/html5.quality_rule">HTML5/Javascript sample project</a></li>
</ul>
</div></blockquote>
<ul class="simple">
<li>Python</li>
</ul>
<blockquote>
<div><ul class="simple">
<li><a class="reference external" href="https://github.com/CAST-projects/Extension-SDK/tree/master/samples/analyzer_level/python/python.quality_rule">Python sample project</a></li>
</ul>
</div></blockquote>
</div>
<div class="section" id="initialization">
<h3>Initialization<a class="headerlink" href="#initialization" title="Permalink to this headline">¶</a></h3>
<div class="section" id="plugin-id">
<h4>Plugin id<a class="headerlink" href="#plugin-id" title="Permalink to this headline">¶</a></h4>
<p>First you need to choose :</p>
<ul class="simple">
<li>a unique plugin id</li>
</ul>
<p>This plugin id will be used in plugin.nuspec file.</p>
<p>In this tutorial we have chosen <strong>mainframe.quality_rule</strong>.</p>
<p>See <a class="reference internal" href="deployment.html"><em>Deploying plugins</em></a></p>
</div>
<div class="section" id="pck-name">
<h4>Pck name<a class="headerlink" href="#pck-name" title="Permalink to this headline">¶</a></h4>
<p>Then you also need to have a unique name for the pck.
We recommend that this name contain the the plugin id.</p>
<p>In this tutorial we have chosen <strong>mainframe.sample.qr_metric_tree</strong>.</p>
<p>This name is then used in the compile.bat:</p>
<div class="highlight-python"><div class="highlight"><pre>MasterFiles\MetricsCompiler.bat -encodeUA -inputdir MasterFiles -outputdir . -pck mainframe.quality_rule_metric_tree
</pre></div>
</div>
</div>
<div class="section" id="metamodel-ids">
<h4>Metamodel ids<a class="headerlink" href="#metamodel-ids" title="Permalink to this headline">¶</a></h4>
<p>Then you need to choose a metamodel file_id.</p>
<p>See <a class="reference external" href="https://doc.castsoftware.com/display/DOC83/xxxMetaModel.xml+file#xxxMetaModel.xmlfile-IDassignmentscheme">https://doc.castsoftware.com/display/DOC83/xxxMetaModel.xml+file#xxxMetaModel.xmlfile-IDassignmentscheme</a></p>
<p>The absolute ids are 2,000,000 + 1,000 * file_no + rid</p>
<p>Here, as it is custom quality rule the level is <strong>&#8220;client&#8221;</strong> and we have chosen file_id <strong>&#8220;1&#8221;</strong>.</p>
<p>So the absolute ids are between 2,001,000 and 2,001,999.</p>
<p>We will use this id range both for metamodel and for quality rule ids.</p>
</div>
<div class="section" id="a-custom-category">
<h4>A custom category<a class="headerlink" href="#a-custom-category" title="Permalink to this headline">¶</a></h4>
<p>Then we need to choose a name for our custom category. This name should be globally unique and do not clash with other category names.</p>
<p>Here we choose : <strong>MyCompany_COBOL_Rules</strong>.</p>
<p>This category is added to the COBOL programs, see  <a class="reference internal" href="mainframe.html#mainframe-categories"><em>Categories and types for quality rules</em></a>.</p>
<p>Doing a mistake and having the same category name in 2 different extensions will prevent those extensions to be installed on the same CAIP instance.</p>
</div>
</div>
<div class="section" id="adding-a-new-quality-rule">
<h3>Adding a new quality rule<a class="headerlink" href="#adding-a-new-quality-rule" title="Permalink to this headline">¶</a></h3>
<p>For adding a new quality rule we need to add:</p>
<ul class="simple">
<li>a metamodel property on the mainframe object type (on which the rule applies)</li>
<li>an implementation in extension SDK</li>
<li>a declaration in the master files</li>
</ul>
</div>
<div class="section" id="adding-a-property">
<h3>Adding a property<a class="headerlink" href="#adding-a-property" title="Permalink to this headline">¶</a></h3>
<p>We add a property in our custom category, for that we need:</p>
<ul class="simple">
<li>a name (that should be unique inside the category)</li>
<li>a rid (that should be unique inside the metamodel file)</li>
<li>an INF_SUB_TYPE (that should be unique inside the metamodel file)</li>
</ul>
<p>By convention we set the lower range value for the INF_TYPE.</p>
<p>This gives</p>
<div class="highlight-python"><div class="highlight"><pre>&lt;category name=&quot;MyCompany_COBOL_Rules&quot; rid=&quot;0&quot;&gt;
    &lt;description&gt;&lt;/description&gt;
    &lt;!-- add new properties here, one for each quality rule --&gt;

    &lt;property name=&quot;paragraphRedefinition&quot; type=&quot;integer&quot; merge=&quot;sum&quot; rid=&quot;0&quot;&gt;
        &lt;description&gt;Redefinition of paragraph&lt;/description&gt;
        &lt;attribute name=&quot;ACCESS_APPVIEW&quot; intValue=&quot;1&quot;/&gt;
        &lt;attribute name=&quot;ACCESS_CVS&quot; intValue=&quot;1&quot;/&gt;
        &lt;attribute name=&quot;ACCESS_HTML&quot; intValue=&quot;1&quot;/&gt;
        &lt;attribute name=&quot;INF_TYPE&quot; intValue=&quot;2001000&quot;/&gt;
        &lt;attribute name=&quot;INF_SUB_TYPE&quot; intValue=&quot;0&quot;/&gt;
    &lt;/property&gt;

&lt;/category&gt;
</pre></div>
</div>
<p>Apply the formula to determine the absolute id value (2,000,000 + 1,000 * file_no + rid) : here the property id is 2001000.</p>
<p>Keep that value in mind.</p>
</div>
<div class="section" id="implementation-in-python">
<h3>Implementation in Python<a class="headerlink" href="#implementation-in-python" title="Permalink to this headline">¶</a></h3>
<p>We will use <a class="reference internal" href="code_reference.html#cast.analysers.Object.save_violation" title="cast.analysers.Object.save_violation"><tt class="xref py py-meth docutils literal"><span class="pre">cast.analysers.Object.save_violation()</span></tt></a> to register a violation on some object at a given position in the code.</p>
<p>The property name will be : &#8220;MyCompany_COBOL_Rules.paragraphRedefinition&#8221;</p>
<p>See &#64;todo</p>
</div>
<div class="section" id="adding-the-rule-in-the-master-files">
<h3>Adding the rule in the master files<a class="headerlink" href="#adding-the-rule-in-the-master-files" title="Permalink to this headline">¶</a></h3>
<p>Master files are the xml files located in MasterFiles subfolder.</p>
<p>Each one need to be updated to add a new quality rule.</p>
<p>First We need a unique rule id.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Rule id must be <strong>even</strong>.</p>
</div>
<p>We start by choosing <strong>2001000</strong>, next one will be 2001002, etc...</p>
<div class="section" id="metricsdirectory-xml">
<h4>MetricsDirectory.xml<a class="headerlink" href="#metricsdirectory-xml" title="Permalink to this headline">¶</a></h4>
<p>This one contains the list of quality rules.</p>
<p>It also contains some existing &#8216;technical-criterion&#8217; to which rules should be added.</p>
<p>Here we provide some classical &#8216;technical-criterion&#8217;, but some other exists.</p>
<p>Here is what change</p>
<div class="highlight-python"><div class="highlight"><pre>&lt;metric id=&#39;2001000&#39; type=&#39;quality-rule&#39; originalName=&#39;Avoid redefining paragraph&#39; active=&#39;true&#39; detached=&#39;false&#39; ignored=&#39;false&#39; /&gt;
</pre></div>
</div>
</div>
<div class="section" id="implqualityrules-xml">
<h4>IMPLQualityRules.xml<a class="headerlink" href="#implqualityrules-xml" title="Permalink to this headline">¶</a></h4>
<p>This explains how the rule is calculated.</p>
<p>Here we are in a property/scope mode.</p>
<p>Here we need to choose a scope : this represent the set of objects checked by the rule.</p>
<p>Here we are checking every COBOL program, so we choose scope id 100. See see  <a class="reference internal" href="mainframe.html#mainframe-scopes"><em>Quality rule scopes</em></a>.</p>
<p>We have</p>
<ul class="simple">
<li>our rule id : 2001000</li>
<li>our property id : 2001000</li>
<li>our scope id : 100</li>
</ul>
<div class="highlight-python"><div class="highlight"><pre>&lt;metric id=&#39;2001000&#39; type=&#39;quality-rule&#39; originalName=&#39;Avoid redefining paragraph&#39; xxl=&#39;N/A&#39; unify=&#39;N/A&#39; executionLocation=&#39;local-central&#39; scopeID=&#39;100&#39; scopeLabel=&#39;NO LABEL&#39; propertyID=&#39;2001000&#39; associatedValueResultType=&#39;integer&#39; failedChecksOperator1=&#39;count-distinct&#39; failedChecksProcedure=&#39;DSS_DIAG_SCOPE_GENERIC_NUM&#39; totalChecksProcedure=&#39;DSS_DIAG_TOTAL_GENERIC&#39; consolidationLocalProcedure=&#39;DSS_FILTER_SCOPE&#39; consolidationCentralProcedure=&#39;N/A&#39; /&gt;
</pre></div>
</div>
<p>See &#8220;Computing Settings tab&#8221; in <a class="reference external" href="https://doc.castsoftware.com/display/DOC83/CMS+-+Create+a+new+Quality+Rule">https://doc.castsoftware.com/display/DOC83/CMS+-+Create+a+new+Quality+Rule</a>.</p>
</div>
<div class="section" id="specthresholds-xml">
<h4>SPECThresholds.xml<a class="headerlink" href="#specthresholds-xml" title="Permalink to this headline">¶</a></h4>
<p>This describe how we get a grade from a compliance ratio.</p>
<div class="highlight-python"><div class="highlight"><pre>&lt;metric id=&quot;2001000&quot; type=&quot;quality-rule&quot; originalName=&quot;Avoid redefining paragraph&quot; thresholdToGet1=&#39;50.0&#39; thresholdToGet2=&#39;90.0&#39; thresholdToGet3=&#39;95.0&#39; thresholdToGet4=&#39;99.0&#39; /&gt;
</pre></div>
</div>
<p>See &#8220;Grade Thresholds tab&#8221; in <a class="reference external" href="https://doc.castsoftware.com/display/DOC83/CMS+-+Create+a+new+Quality+Rule">https://doc.castsoftware.com/display/DOC83/CMS+-+Create+a+new+Quality+Rule</a>.</p>
</div>
<div class="section" id="speccontributors-xml">
<h4>SPECContributors.xml<a class="headerlink" href="#speccontributors-xml" title="Permalink to this headline">¶</a></h4>
<p>This describe to which &#8216;technical-criterion&#8217; the rule will contribute.</p>
<div class="highlight-python"><div class="highlight"><pre>&lt;metric id=&#39;66069&#39; type=&#39;technical-criterion&#39; originalName=&#39;Programming Practices - Unexpected Behavior&#39; contributorId=&#39;2001000&#39; contributorType=&#39;quality-rule&#39; contributorOriginalName=&#39;2001000&#39; critical=&#39;false&#39; weight=&#39;5&#39; /&gt;
</pre></div>
</div>
<p>See &#8220;Grade Impacts tab&#8221; in <a class="reference external" href="https://doc.castsoftware.com/display/DOC83/CMS+-+Create+a+new+Quality+Rule">https://doc.castsoftware.com/display/DOC83/CMS+-+Create+a+new+Quality+Rule</a>.</p>
</div>
<div class="section" id="impltechnologies-xml">
<h4>IMPLTechnologies.xml<a class="headerlink" href="#impltechnologies-xml" title="Permalink to this headline">¶</a></h4>
<p>Rules are associated to one or several technologies.</p>
<p>In this sample the technology is Cobol, so -4</p>
<div class="highlight-python"><div class="highlight"><pre>&lt;metric id=&#39;2001000&#39; type=&#39;quality-rule&#39; originalName=&#39;Avoid redefining paragraph&#39; filter=&#39;-4&#39; filterLabel=&#39;Cobol&#39; /&gt;
</pre></div>
</div>
<p>See &#8220;Computing Settings tab&#8221; in <a class="reference external" href="https://doc.castsoftware.com/display/DOC83/CMS+-+Create+a+new+Quality+Rule">https://doc.castsoftware.com/display/DOC83/CMS+-+Create+a+new+Quality+Rule</a>.</p>
</div>
<div class="section" id="specdocumentation-xml">
<h4>SPECDocumentation.xml<a class="headerlink" href="#specdocumentation-xml" title="Permalink to this headline">¶</a></h4>
<p>This contains the various fields of documentation.</p>
<p>See <a class="reference external" href="https://doc.castsoftware.com/display/DOC83/CMS+-+Create+a+new+Quality+Rule">https://doc.castsoftware.com/display/DOC83/CMS+-+Create+a+new+Quality+Rule</a></p>
</div>
</div>
<div class="section" id="compiling-the-master-files">
<h3>Compiling the master files<a class="headerlink" href="#compiling-the-master-files" title="Permalink to this headline">¶</a></h3>
<p>Once edited, you can compile the master files by running compile.bat <em>in a console</em> ran the folder of the extension.</p>
<p>It will generate a folder named InstallScripts</p>
</div>
<div class="section" id="done">
<h3>Done<a class="headerlink" href="#done" title="Permalink to this headline">¶</a></h3>
<p>That&#8217;s it. Now you can test.</p>
</div>
</div>
<div class="section" id="some-other-ways-of-writing-quality-rules">
<h2>Some other ways of writing quality rules<a class="headerlink" href="#some-other-ways-of-writing-quality-rules" title="Permalink to this headline">¶</a></h2>
<p>Those applies for some other ways of writing quality rules, some are deprecated.</p>
<div class="section" id="old-way-of-writing-quality-rules">
<h3>Old way of writing quality rules<a class="headerlink" href="#old-way-of-writing-quality-rules" title="Permalink to this headline">¶</a></h3>
<p>For the implementation, two stored procedures are required:</p>
<ul class="simple">
<li>A detail procedure to identify violations</li>
<li>A total procedure to compute the size of the test population</li>
</ul>
<p>The detail procedure will insert lines into DSS_METRIC_SCOPES representing the fact that an object violates a rule.</p>
<p>Sample for the search of undocumented programs</p>
<div class="highlight-python"><div class="highlight"><pre>CREATE OR REPLACE FUNCTION DIAG_SCOPE_COBDOC004 (
        I_SNAPSHOT_ID INT,              -- the metric snapshot id
        I_METRIC_PARENT_ID INT, -- the metric parent id
        I_METRIC_ID INT,                        -- the metric id
        I_METRIC_CHILD_ID INT
)
returns INT
as
$body$
declare
           ERRORCODE    INT:=0;
Begin

--&lt;&lt;NAME&gt;&gt;DIAG_SCOPE_COBDOC004&lt;&lt;/NAME&gt;&gt;
--&lt;&lt;COMMENT&gt;&gt; Template name   = UNDOCUMENTED. &lt;&lt;/COMMENT&gt;&gt;
--&lt;&lt;COMMENT&gt;&gt; Diagnostic name = Avoid undocumented Programs. &lt;&lt;/COMMENT&gt;&gt;
--&lt;&lt;COMMENT&gt;&gt; Definition      = Avoid undocumented Programs. &lt;&lt;/COMMENT&gt;&gt;
--&lt;&lt;COMMENT&gt;&gt; Action          = Lists all Programs that have neither heading comments nor inline comments. &lt;&lt;/COMMENT&gt;&gt;
--&lt;&lt;COMMENT&gt;&gt; Value           = 1. &lt;&lt;/COMMENT&gt;&gt;

  insert into DSS_METRIC_SCOPES
        (OBJECT_ID, METRIC_PARENT_ID, METRIC_ID, OBJECT_PARENT_ID, SNAPSHOT_ID, METRIC_NUM_VALUE, METRIC_OBJECT_ID, COMPUTE_VALUE)
  select T1.OBJECT_ID, I_METRIC_ID, I_METRIC_CHILD_ID, SC.MODULE_ID, I_SNAPSHOT_ID, 1, 0, 0
    from CTT_OBJECT_APPLICATIONS T1, DSSAPP_MODULES SC , ObjInf OI
        where SC.TECHNO_TYPE                                    = -4   -- Technologic Cobol object
          and T1.APPLICATION_ID                 = SC.MODULE_ID
      and T1.OBJECT_TYPE                                = 545 -- &#39;Cobol Program&#39;
          and T1.PROPERTIES = 0 -- Application&#39;s Object
          and not exists ( select 1
                             from DSS_OBJECT_EXCEPTIONS E
                                    where E.METRIC_ID   = I_METRIC_ID
                                          and E.OBJECT_ID       = T1.OBJECT_ID
                              )
      and exists ( select 1
                          from ObjInf T2
                                     where T2.IdObj = T1.OBJECT_ID
                       and T2.InfTyp = 114 and T2.InfSubTyp = 1 -- Number of heading comment lines
                                           and T2.InfVal = 0
                           )
          and exists ( select 1
                          from ObjInf T3
                                     where T3.IdObj = T1.OBJECT_ID
                       and T3.InfTyp = 2 and T3.InfSubTyp = 0 -- Number of inner comment lines
                                           and T3.InfVal = 0
                           )

and T1.OBJECT_ID = OI.IdObj and OI.InfTyp    = 1 and OI.InfSubTyp = 0 and OI.InfVal &gt; 0 -- has Code line


        ;
Return ERRORCODE;
End;
$body$
language &#39;plpgsql&#39;
/
</pre></div>
</div>
<p>A total procedure insert lines into DSS_METRIC_RESULTS that represent the count of scanned objects.</p>
<p>For example the detail procedure for the undocumented programs</p>
<div class="highlight-python"><div class="highlight"><pre>CREATE OR REPLACE FUNCTION DIAG_COBOL_ANA_PROGRAM_TOTAL (
        I_SNAPSHOT_ID          INT,             -- the metric snapshot id
        I_METRIC_PARENT_ID     INT,     -- the metric parent id
        I_METRIC_ID            INT,                     -- the metric id
        I_METRIC_VALUE_INDEX   INT
)
returns int
as
$body$
declare
        ERRORCODE       int;
Begin
    ERRORCODE  := 0;
--&lt;&lt;NAME&gt;&gt;DIAG_COBOL_ANA_PROGRAM_TOTAL&lt;&lt;/NAME&gt;&gt;*/
--&lt;&lt;COMMENT&gt;&gt; Template name   = TOTAL. &lt;&lt;/COMMENT&gt;&gt;
--&lt;&lt;COMMENT&gt;&gt; Definition      = Count of program programs. &lt;&lt;/COMMENT&gt;&gt;

    Insert Into DSS_METRIC_RESULTS
                (METRIC_NUM_VALUE, METRIC_OBJECT_ID, OBJECT_ID, METRIC_ID, METRIC_VALUE_INDEX, SNAPSHOT_ID)
    select
                Count(T1.OBJECT_ID), 0, SC.OBJECT_PARENT_ID, I_METRIC_ID, I_METRIC_VALUE_INDEX, I_SNAPSHOT_ID
    from
        CTT_OBJECT_APPLICATIONS T1, DSSAPP_MODULES MO, DSS_METRIC_SCOPES SC
    where
            SC.SNAPSHOT_ID              = I_SNAPSHOT_ID
            and SC.METRIC_PARENT_ID     = I_METRIC_PARENT_ID
            and SC.METRIC_ID            = I_METRIC_ID
                and SC.COMPUTE_VALUE            = 0
                and MO.TECHNO_TYPE                      = -4   -- Technologic Cobol object
                and MO.MODULE_ID                        = SC.OBJECT_ID
                and T1.APPLICATION_ID           = SC.OBJECT_ID
                and T1.OBJECT_TYPE                      =     545 -- &#39;Cobol Program&#39;
                and T1.PROPERTIES = 0 -- Application&#39;s Object

                and Not Exists
                (
                        select 1
                        from
                                DSS_OBJECT_EXCEPTIONS E
                        where
                                E.METRIC_ID             = I_METRIC_ID
                                and E.OBJECT_ID = T1.OBJECT_ID
                )
    Group By SC.OBJECT_PARENT_ID, SC.OBJECT_ID
        ;
Return ERRORCODE;
End;
$body$
language &#39;plpgsql&#39;
/
</pre></div>
</div>
<p>Those procedures uses the object model stored in the knowledge base. This uses objects and properties.</p>
<p>One can use existing properties, and also use new properties (that the should be produced)</p>
</div>
<div class="section" id="different-ways-of-producing-properties">
<h3>Different ways of producing properties<a class="headerlink" href="#different-ways-of-producing-properties" title="Permalink to this headline">¶</a></h3>
<p>The values of the properties may be produced using various ways :</p>
<ul class="simple">
<li>through SDK using either <a class="reference internal" href="code_reference.html#cast.analysers.Object.save_violation" title="cast.analysers.Object.save_violation"><tt class="xref py py-meth docutils literal"><span class="pre">cast.analysers.Object.save_violation()</span></tt></a> or <a class="reference internal" href="code_reference.html#cast.application.Object.save_property" title="cast.application.Object.save_property"><tt class="xref py py-meth docutils literal"><span class="pre">cast.application.Object.save_property()</span></tt></a></li>
<li>using Metric Assistant : <a class="reference external" href="http://doc.castsoftware.com/display/DOC80/Using+the+XXXCastMetrics.xml+file">http://doc.castsoftware.com/display/DOC80/Using+the+XXXCastMetrics.xml+file</a>
by adding a xxxCastMEtrics.xml file in your extension</li>
</ul>
</div>
</div>
<div class="section" id="packaging">
<h2>Packaging<a class="headerlink" href="#packaging" title="Permalink to this headline">¶</a></h2>
<div class="section" id="adding-the-rule-manually-to-cms">
<h3>Adding the rule manually to CMS<a class="headerlink" href="#adding-the-rule-manually-to-cms" title="Permalink to this headline">¶</a></h3>
<p>This is a good start for testing</p>
<p><a class="reference external" href="https://doc.castsoftware.com/display/DOC83/CMS+-+Create+a+new+Quality+Rule">https://doc.castsoftware.com/display/DOC83/CMS+-+Create+a+new+Quality+Rule</a></p>
</div>
</div>
<div class="section" id="enhancing-dataflow-quality-rules">
<h2>Enhancing dataflow quality rules<a class="headerlink" href="#enhancing-dataflow-quality-rules" title="Permalink to this headline">¶</a></h2>
<div class="section" id="configuring-dataflow">
<h3>Configuring dataflow<a class="headerlink" href="#configuring-dataflow" title="Permalink to this headline">¶</a></h3>
<p>For quality rules involving data flow, please see the data flow blackboxing documentation : <a class="reference external" href="http://doc.castsoftware.com/display/DOC82/User+Input+Security+-+configuring+blackbox+methods">http://doc.castsoftware.com/display/DOC82/User+Input+Security+-+configuring+blackbox+methods</a>.</p>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="code_reference.html" class="btn btn-neutral float-right" title="API Reference" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="debugging.html" class="btn btn-neutral" title="Debugging" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2014, CAST.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.6.6',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>